{"version":3,"sources":["serialize.js"],"names":[],"mappings":"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","file":"serialize-compiled.js","sourcesContent":["var test = require('tap').test\nvar LRU = require('../')\n\ntest('dump', function (t) {\n  var cache = new LRU()\n\n  t.equal(cache.dump().length, 0, \"nothing in dump for empty cache\")\n\n  cache.set(\"a\", \"A\")\n  cache.set(\"b\", \"B\")\n  t.deepEqual(cache.dump(), [\n    { k: \"b\", v: \"B\", e: 0 },\n    { k: \"a\", v: \"A\", e: 0 }\n  ])\n\n  cache.set(\"a\", \"A\");\n  t.deepEqual(cache.dump(), [\n    { k: \"a\", v: \"A\", e: 0 },\n    { k: \"b\", v: \"B\", e: 0 }\n  ])\n\n  cache.get(\"b\");\n  t.deepEqual(cache.dump(), [\n    { k: \"b\", v: \"B\", e: 0 },\n    { k: \"a\", v: \"A\", e: 0 }\n  ])\n\n  cache.del(\"a\");\n  t.deepEqual(cache.dump(), [\n    { k: \"b\", v: \"B\",  e: 0 }\n  ])\n\n  t.end()\n})\n\ntest(\"do not dump stale items\", function(t) {\n  var cache = new LRU({\n    max: 5,\n    maxAge: 50\n  })\n\n  //expires at 50\n  cache.set(\"a\", \"A\")\n\n  setTimeout(function () {\n    //expires at 75\n    cache.set(\"b\", \"B\")\n    var s = cache.dump()\n    t.equal(s.length, 2)\n    t.equal(s[0].k, \"b\")\n    t.equal(s[1].k, \"a\")\n  }, 25)\n\n  setTimeout(function () {\n    //expires at 110\n    cache.set(\"c\", \"C\")\n    var s = cache.dump()\n    t.equal(s.length, 2)\n    t.equal(s[0].k, \"c\")\n    t.equal(s[1].k, \"b\")\n  }, 60)\n\n  setTimeout(function () {\n    //expires at 130\n    cache.set(\"d\", \"D\", 40)\n    var s = cache.dump()\n    t.equal(s.length, 2)\n    t.equal(s[0].k, \"d\")\n    t.equal(s[1].k, \"c\")\n  }, 90)\n\n  setTimeout(function () {\n    var s = cache.dump()\n    t.equal(s.length, 1)\n    t.equal(s[0].k, \"d\")\n  }, 120)\n\n  setTimeout(function () {\n    var s = cache.dump()\n    t.deepEqual(s, [])\n    t.end()\n  }, 155)\n})\n\ntest(\"load basic cache\", function(t) {\n  var cache = new LRU(),\n      copy = new LRU()\n\n  cache.set(\"a\", \"A\")\n  cache.set(\"b\", \"B\")\n\n  copy.load(cache.dump())\n  t.deepEquals(cache.dump(), copy.dump())\n\n  t.end()\n})\n\n\ntest(\"load staled cache\", function(t) {\n  var cache = new LRU({maxAge: 50}),\n      copy = new LRU({maxAge: 50}),\n      arr\n\n  //expires at 50\n  cache.set(\"a\", \"A\")\n  setTimeout(function () {\n    //expires at 80\n    cache.set(\"b\", \"B\")\n    arr = cache.dump()\n    t.equal(arr.length, 2)\n  }, 30)\n\n  setTimeout(function () {\n    copy.load(arr)\n    t.equal(copy.get(\"a\"), undefined)\n    t.equal(copy.get(\"b\"), \"B\")\n  }, 60)\n\n  setTimeout(function () {\n    t.equal(copy.get(\"b\"), undefined)\n    t.end()\n  }, 90)\n})\n\ntest(\"load to other size cache\", function(t) {\n  var cache = new LRU({max: 2}),\n      copy = new LRU({max: 1})\n\n  cache.set(\"a\", \"A\")\n  cache.set(\"b\", \"B\")\n\n  copy.load(cache.dump())\n  t.equal(copy.get(\"a\"), undefined)\n  t.equal(copy.get(\"b\"), \"B\")\n\n  //update the last read from original cache\n  cache.get(\"a\")\n  copy.load(cache.dump())\n  t.equal(copy.get(\"a\"), \"A\")\n  t.equal(copy.get(\"b\"), undefined)\n\n  t.end()\n})\n\n\ntest(\"load to other age cache\", function(t) {\n  var cache = new LRU({maxAge: 50}),\n      aged = new LRU({maxAge: 100}),\n      simple = new LRU(),\n      arr,\n      expired\n\n  //created at 0\n  //a would be valid till 0 + 50\n  cache.set(\"a\", \"A\")\n  setTimeout(function () {\n    //created at 20\n    //b would be valid till 20 + 50\n    cache.set(\"b\", \"B\")\n    //b would be valid till 20 + 70\n    cache.set(\"c\", \"C\", 70)\n    arr = cache.dump()\n    t.equal(arr.length, 3)\n  }, 20)\n\n  setTimeout(function () {\n    t.equal(cache.get(\"a\"), undefined)\n    t.equal(cache.get(\"b\"), \"B\")\n    t.equal(cache.get(\"c\"), \"C\")\n\n    aged.load(arr)\n    t.equal(aged.get(\"a\"), undefined)\n    t.equal(aged.get(\"b\"), \"B\")\n    t.equal(aged.get(\"c\"), \"C\")\n\n    simple.load(arr)\n    t.equal(simple.get(\"a\"), undefined)\n    t.equal(simple.get(\"b\"), \"B\")\n    t.equal(simple.get(\"c\"), \"C\")\n  }, 60)\n\n  setTimeout(function () {\n    t.equal(cache.get(\"a\"), undefined)\n    t.equal(cache.get(\"b\"), undefined)\n    t.equal(cache.get(\"c\"), \"C\")\n\n    aged.load(arr)\n    t.equal(aged.get(\"a\"), undefined)\n    t.equal(aged.get(\"b\"), undefined)\n    t.equal(aged.get(\"c\"), \"C\")\n\n    simple.load(arr)\n    t.equal(simple.get(\"a\"), undefined)\n    t.equal(simple.get(\"b\"), undefined)\n    t.equal(simple.get(\"c\"), \"C\")\n  }, 80)\n\n  setTimeout(function () {\n    t.equal(cache.get(\"a\"), undefined)\n    t.equal(cache.get(\"b\"), undefined)\n    t.equal(cache.get(\"c\"), undefined)\n\n    aged.load(arr)\n    t.equal(aged.get(\"a\"), undefined)\n    t.equal(aged.get(\"b\"), undefined)\n    t.equal(aged.get(\"c\"), undefined)\n\n    simple.load(arr)\n    t.equal(simple.get(\"a\"), undefined)\n    t.equal(simple.get(\"b\"), undefined)\n    t.equal(simple.get(\"c\"), undefined)\n    t.end()\n  }, 100)\n\n})\n\n"]}