{"version":3,"sources":["foreach.js"],"names":[],"mappings":"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","file":"foreach-compiled.js","sourcesContent":["var test = require('tap').test\nvar LRU = require('../')\n\ntest('forEach', function (t) {\n  var l = new LRU(5)\n  for (var i = 0; i < 10; i ++) {\n    l.set(i.toString(), i.toString(2))\n  }\n\n  var i = 9\n  l.forEach(function (val, key, cache) {\n    t.equal(cache, l)\n    t.equal(key, i.toString())\n    t.equal(val, i.toString(2))\n    i -= 1\n  })\n\n  // get in order of most recently used\n  l.get(6)\n  l.get(8)\n\n  var order = [ 8, 6, 9, 7, 5 ]\n  var i = 0\n\n  l.forEach(function (val, key, cache) {\n    var j = order[i ++]\n    t.equal(cache, l)\n    t.equal(key, j.toString())\n    t.equal(val, j.toString(2))\n  })\n  t.equal(i, order.length);\n\n  t.end()\n})\n\ntest('keys() and values()', function (t) {\n  var l = new LRU(5)\n  for (var i = 0; i < 10; i ++) {\n    l.set(i.toString(), i.toString(2))\n  }\n\n  t.similar(l.keys(), ['9', '8', '7', '6', '5'])\n  t.similar(l.values(), ['1001', '1000', '111', '110', '101'])\n\n  // get in order of most recently used\n  l.get(6)\n  l.get(8)\n\n  t.similar(l.keys(), ['8', '6', '9', '7', '5'])\n  t.similar(l.values(), ['1000', '110', '1001', '111', '101'])\n\n  t.end()\n})\n\ntest('all entries are iterated over', function(t) {\n  var l = new LRU(5)\n  for (var i = 0; i < 10; i ++) {\n    l.set(i.toString(), i.toString(2))\n  }\n\n  var i = 0\n  l.forEach(function (val, key, cache) {\n    if (i > 0) {\n      cache.del(key)\n    }\n    i += 1\n  })\n\n  t.equal(i, 5)\n  t.equal(l.keys().length, 1)\n\n  t.end()\n})\n\ntest('all stale entries are removed', function(t) {\n  var l = new LRU({ max: 5, maxAge: -5, stale: true })\n  for (var i = 0; i < 10; i ++) {\n    l.set(i.toString(), i.toString(2))\n  }\n\n  var i = 0\n  l.forEach(function () {\n    i += 1\n  })\n\n  t.equal(i, 5)\n  t.equal(l.keys().length, 0)\n\n  t.end()\n})\n\ntest('expires', function (t) {\n  var l = new LRU({\n    max: 10,\n    maxAge: 50\n  })\n  for (var i = 0; i < 10; i++) {\n    l.set(i.toString(), i.toString(2), ((i % 2) ? 25 : undefined))\n  }\n\n  var i = 0\n  var order = [ 8, 6, 4, 2, 0 ]\n  setTimeout(function () {\n    l.forEach(function (val, key, cache) {\n      var j = order[i++]\n      t.equal(cache, l)\n      t.equal(key, j.toString())\n      t.equal(val, j.toString(2))\n    })\n    t.equal(i, order.length);\n\n    setTimeout(function () {\n      var count = 0;\n      l.forEach(function (val, key, cache) { count++; })\n      t.equal(0, count);\n      t.end()\n    }, 25)\n\n  }, 26)\n})\n"]}