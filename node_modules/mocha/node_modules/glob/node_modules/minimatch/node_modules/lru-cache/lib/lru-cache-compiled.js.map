{"version":3,"sources":["lru-cache.js"],"names":[],"mappings":"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","file":"lru-cache-compiled.js","sourcesContent":[";(function () { // closure for web browsers\n\nif (typeof module === 'object' && module.exports) {\n  module.exports = LRUCache\n} else {\n  // just set the global for non-node platforms.\n  this.LRUCache = LRUCache\n}\n\nfunction hOP (obj, key) {\n  return Object.prototype.hasOwnProperty.call(obj, key)\n}\n\nfunction naiveLength () { return 1 }\n\nvar didTypeWarning = false\nfunction typeCheckKey(key) {\n  if (!didTypeWarning && typeof key !== 'string' && typeof key !== 'number') {\n    didTypeWarning = true\n    console.error(new TypeError(\"LRU: key must be a string or number. Almost certainly a bug! \" + typeof key).stack)\n  }\n}\n\nfunction LRUCache (options) {\n  if (!(this instanceof LRUCache))\n    return new LRUCache(options)\n\n  if (typeof options === 'number')\n    options = { max: options }\n\n  if (!options)\n    options = {}\n\n  this._max = options.max\n  // Kind of weird to have a default max of Infinity, but oh well.\n  if (!this._max || !(typeof this._max === \"number\") || this._max <= 0 )\n    this._max = Infinity\n\n  this._lengthCalculator = options.length || naiveLength\n  if (typeof this._lengthCalculator !== \"function\")\n    this._lengthCalculator = naiveLength\n\n  this._allowStale = options.stale || false\n  this._maxAge = options.maxAge || null\n  this._dispose = options.dispose\n  this.reset()\n}\n\n// resize the cache when the max changes.\nObject.defineProperty(LRUCache.prototype, \"max\",\n  { set : function (mL) {\n      if (!mL || !(typeof mL === \"number\") || mL <= 0 ) mL = Infinity\n      this._max = mL\n      if (this._length > this._max) trim(this)\n    }\n  , get : function () { return this._max }\n  , enumerable : true\n  })\n\n// resize the cache when the lengthCalculator changes.\nObject.defineProperty(LRUCache.prototype, \"lengthCalculator\",\n  { set : function (lC) {\n      if (typeof lC !== \"function\") {\n        this._lengthCalculator = naiveLength\n        this._length = this._itemCount\n        for (var key in this._cache) {\n          this._cache[key].length = 1\n        }\n      } else {\n        this._lengthCalculator = lC\n        this._length = 0\n        for (var key in this._cache) {\n          this._cache[key].length = this._lengthCalculator(this._cache[key].value)\n          this._length += this._cache[key].length\n        }\n      }\n\n      if (this._length > this._max) trim(this)\n    }\n  , get : function () { return this._lengthCalculator }\n  , enumerable : true\n  })\n\nObject.defineProperty(LRUCache.prototype, \"length\",\n  { get : function () { return this._length }\n  , enumerable : true\n  })\n\n\nObject.defineProperty(LRUCache.prototype, \"itemCount\",\n  { get : function () { return this._itemCount }\n  , enumerable : true\n  })\n\nLRUCache.prototype.forEach = function (fn, thisp) {\n  thisp = thisp || this\n  var i = 0\n  var itemCount = this._itemCount\n\n  for (var k = this._mru - 1; k >= 0 && i < itemCount; k--) if (this._lruList[k]) {\n    i++\n    var hit = this._lruList[k]\n    if (isStale(this, hit)) {\n      del(this, hit)\n      if (!this._allowStale) hit = undefined\n    }\n    if (hit) {\n      fn.call(thisp, hit.value, hit.key, this)\n    }\n  }\n}\n\nLRUCache.prototype.keys = function () {\n  var keys = new Array(this._itemCount)\n  var i = 0\n  for (var k = this._mru - 1; k >= 0 && i < this._itemCount; k--) if (this._lruList[k]) {\n    var hit = this._lruList[k]\n    keys[i++] = hit.key\n  }\n  return keys\n}\n\nLRUCache.prototype.values = function () {\n  var values = new Array(this._itemCount)\n  var i = 0\n  for (var k = this._mru - 1; k >= 0 && i < this._itemCount; k--) if (this._lruList[k]) {\n    var hit = this._lruList[k]\n    values[i++] = hit.value\n  }\n  return values\n}\n\nLRUCache.prototype.reset = function () {\n  if (this._dispose && this._cache) {\n    for (var k in this._cache) {\n      this._dispose(k, this._cache[k].value)\n    }\n  }\n\n  this._cache = Object.create(null) // hash of items by key\n  this._lruList = Object.create(null) // list of items in order of use recency\n  this._mru = 0 // most recently used\n  this._lru = 0 // least recently used\n  this._length = 0 // number of items in the list\n  this._itemCount = 0\n}\n\nLRUCache.prototype.dump = function () {\n  var arr = []\n  var i = 0\n\n  for (var k = this._mru - 1; k >= 0 && i < this._itemCount; k--) if (this._lruList[k]) {\n    var hit = this._lruList[k]\n    if (!isStale(this, hit)) {\n      //Do not store staled hits\n      ++i\n      arr.push({\n        k: hit.key,\n        v: hit.value,\n        e: hit.now + (hit.maxAge || 0)\n      });\n    }\n  }\n  //arr has the most read first\n  return arr\n}\n\nLRUCache.prototype.dumpLru = function () {\n  return this._lruList\n}\n\nLRUCache.prototype.set = function (key, value, maxAge) {\n  maxAge = maxAge || this._maxAge\n  typeCheckKey(key)\n\n  var now = maxAge ? Date.now() : 0\n  var len = this._lengthCalculator(value)\n\n  if (hOP(this._cache, key)) {\n    if (len > this._max) {\n      del(this, this._cache[key])\n      return false\n    }\n    // dispose of the old one before overwriting\n    if (this._dispose)\n      this._dispose(key, this._cache[key].value)\n\n    this._cache[key].now = now\n    this._cache[key].maxAge = maxAge\n    this._cache[key].value = value\n    this._length += (len - this._cache[key].length)\n    this._cache[key].length = len\n    this.get(key)\n\n    if (this._length > this._max)\n      trim(this)\n\n    return true\n  }\n\n  var hit = new Entry(key, value, this._mru++, len, now, maxAge)\n\n  // oversized objects fall out of cache automatically.\n  if (hit.length > this._max) {\n    if (this._dispose) this._dispose(key, value)\n    return false\n  }\n\n  this._length += hit.length\n  this._lruList[hit.lu] = this._cache[key] = hit\n  this._itemCount ++\n\n  if (this._length > this._max)\n    trim(this)\n\n  return true\n}\n\nLRUCache.prototype.has = function (key) {\n  typeCheckKey(key)\n  if (!hOP(this._cache, key)) return false\n  var hit = this._cache[key]\n  if (isStale(this, hit)) {\n    return false\n  }\n  return true\n}\n\nLRUCache.prototype.get = function (key) {\n  typeCheckKey(key)\n  return get(this, key, true)\n}\n\nLRUCache.prototype.peek = function (key) {\n  typeCheckKey(key)\n  return get(this, key, false)\n}\n\nLRUCache.prototype.pop = function () {\n  var hit = this._lruList[this._lru]\n  del(this, hit)\n  return hit || null\n}\n\nLRUCache.prototype.del = function (key) {\n  typeCheckKey(key)\n  del(this, this._cache[key])\n}\n\nLRUCache.prototype.load = function (arr) {\n  //reset the cache\n  this.reset();\n\n  var now = Date.now()\n  //A previous serialized cache has the most recent items first\n  for (var l = arr.length - 1; l >= 0; l-- ) {\n    var hit = arr[l]\n    typeCheckKey(hit.k)\n    var expiresAt = hit.e || 0\n    if (expiresAt === 0) {\n      //the item was created without expiration in a non aged cache\n      this.set(hit.k, hit.v)\n    } else {\n      var maxAge = expiresAt - now\n      //dont add already expired items\n      if (maxAge > 0) this.set(hit.k, hit.v, maxAge)\n    }\n  }\n}\n\nfunction get (self, key, doUse) {\n  typeCheckKey(key)\n  var hit = self._cache[key]\n  if (hit) {\n    if (isStale(self, hit)) {\n      del(self, hit)\n      if (!self._allowStale) hit = undefined\n    } else {\n      if (doUse) use(self, hit)\n    }\n    if (hit) hit = hit.value\n  }\n  return hit\n}\n\nfunction isStale(self, hit) {\n  if (!hit || (!hit.maxAge && !self._maxAge)) return false\n  var stale = false;\n  var diff = Date.now() - hit.now\n  if (hit.maxAge) {\n    stale = diff > hit.maxAge\n  } else {\n    stale = self._maxAge && (diff > self._maxAge)\n  }\n  return stale;\n}\n\nfunction use (self, hit) {\n  shiftLU(self, hit)\n  hit.lu = self._mru ++\n  self._lruList[hit.lu] = hit\n}\n\nfunction trim (self) {\n  while (self._lru < self._mru && self._length > self._max)\n    del(self, self._lruList[self._lru])\n}\n\nfunction shiftLU (self, hit) {\n  delete self._lruList[ hit.lu ]\n  while (self._lru < self._mru && !self._lruList[self._lru]) self._lru ++\n}\n\nfunction del (self, hit) {\n  if (hit) {\n    if (self._dispose) self._dispose(hit.key, hit.value)\n    self._length -= hit.length\n    self._itemCount --\n    delete self._cache[ hit.key ]\n    shiftLU(self, hit)\n  }\n}\n\n// classy, since V8 prefers predictable objects.\nfunction Entry (key, value, lu, length, now, maxAge) {\n  this.key = key\n  this.value = value\n  this.lu = lu\n  this.length = length\n  this.now = now\n  if (maxAge) this.maxAge = maxAge\n}\n\n})()\n"]}