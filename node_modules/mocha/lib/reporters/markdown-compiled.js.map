{"version":3,"sources":["markdown.js"],"names":[],"mappings":";;;;AAIA,IAAI,OAAO,QAAQ,QAAR,CAAX;AACA,IAAI,QAAQ,QAAQ,UAAR,CAAZ;;;;;;AAMA,IAAI,eAAe,GAAnB;;;;;;AAMA,UAAU,OAAO,OAAP,GAAiB,QAA3B;;;;;;;;AAQA,SAAS,QAAT,CAAkB,MAAlB,EAA0B;AACxB,OAAK,IAAL,CAAU,IAAV,EAAgB,MAAhB;;AAEA,MAAI,QAAQ,CAAZ;AACA,MAAI,MAAM,EAAV;;AAEA,WAAS,KAAT,CAAe,GAAf,EAAoB;AAClB,WAAO,MAAM,KAAN,EAAa,IAAb,CAAkB,GAAlB,IAAyB,GAAzB,GAA+B,GAAtC;AACD;;AAED,WAAS,MAAT,CAAgB,KAAhB,EAAuB,GAAvB,EAA4B;AAC1B,QAAI,MAAM,GAAV;AACA,QAAI,MAAM,eAAe,MAAM,KAA/B;;AAEA,UAAM,IAAI,GAAJ,IAAW,IAAI,GAAJ,KAAY,EAAE,OAAO,KAAT,EAA7B;AACA,UAAM,MAAN,CAAa,OAAb,CAAqB,UAAS,KAAT,EAAgB;AACnC,aAAO,KAAP,EAAc,GAAd;AACD,KAFD;;AAIA,WAAO,GAAP;AACD;;AAED,WAAS,YAAT,CAAsB,GAAtB,EAA2B,KAA3B,EAAkC;AAChC,MAAE,KAAF;AACA,QAAI,MAAM,EAAV;AACA,QAAI,IAAJ;AACA,SAAK,IAAI,GAAT,IAAgB,GAAhB,EAAqB;AACnB,UAAI,QAAQ,OAAZ,EAAqB;AACnB;AACD;AACD,UAAI,QAAQ,YAAZ,EAA0B;AACxB,eAAO,SAAS,IAAI,SAAJ,CAAc,CAAd,CAAT,GAA4B,GAAnC;AACA,gBAAQ,OAAO,MAAM,IAAN,CAAW,IAAI,GAAJ,EAAS,KAAT,CAAe,SAAf,EAAX,CAAP,GAAgD,KAAxD;AACA,eAAO,MAAM,KAAN,EAAa,IAAb,CAAkB,IAAlB,IAA0B,IAAjC;AACD;AACD,aAAO,aAAa,IAAI,GAAJ,CAAb,EAAuB,KAAvB,CAAP;AACD;AACD,WAAO,GAAP;AACD;;AAED,WAAS,WAAT,CAAqB,KAArB,EAA4B;AAC1B,QAAI,MAAM,OAAO,KAAP,EAAc,EAAd,CAAV;AACA,WAAO,aAAa,GAAb,EAAkB,CAAlB,CAAP;AACD;;AAED,cAAY,OAAO,KAAnB;;AAEA,SAAO,EAAP,CAAU,OAAV,EAAmB,UAAS,KAAT,EAAgB;AACjC,MAAE,KAAF;AACA,QAAI,OAAO,MAAM,IAAN,CAAW,MAAM,SAAN,EAAX,CAAX;AACA,WAAO,cAAc,IAAd,GAAqB,QAArB,GAAgC,IAAvC;AACA,WAAO,MAAM,MAAM,KAAZ,IAAqB,IAA5B;AACD,GALD;;AAOA,SAAO,EAAP,CAAU,WAAV,EAAuB,YAAW;AAChC,MAAE,KAAF;AACD,GAFD;;AAIA,SAAO,EAAP,CAAU,MAAV,EAAkB,UAAS,IAAT,EAAe;AAC/B,QAAI,OAAO,MAAM,KAAN,CAAY,KAAK,IAAjB,CAAX;AACA,WAAO,KAAK,KAAL,GAAa,KAApB;AACA,WAAO,WAAP;AACA,WAAO,OAAO,IAAd;AACA,WAAO,SAAP;AACD,GAND;;AAQA,SAAO,EAAP,CAAU,KAAV,EAAiB,YAAW;AAC1B,YAAQ,MAAR,CAAe,KAAf,CAAqB,SAArB;AACA,YAAQ,MAAR,CAAe,KAAf,CAAqB,YAAY,OAAO,KAAnB,CAArB;AACA,YAAQ,MAAR,CAAe,KAAf,CAAqB,GAArB;AACD,GAJD;AAKD","file":"markdown-compiled.js","sourcesContent":["/**\n * Module dependencies.\n */\n\nvar Base = require('./base');\nvar utils = require('../utils');\n\n/**\n * Constants\n */\n\nvar SUITE_PREFIX = '$';\n\n/**\n * Expose `Markdown`.\n */\n\nexports = module.exports = Markdown;\n\n/**\n * Initialize a new `Markdown` reporter.\n *\n * @api public\n * @param {Runner} runner\n */\nfunction Markdown(runner) {\n  Base.call(this, runner);\n\n  var level = 0;\n  var buf = '';\n\n  function title(str) {\n    return Array(level).join('#') + ' ' + str;\n  }\n\n  function mapTOC(suite, obj) {\n    var ret = obj;\n    var key = SUITE_PREFIX + suite.title;\n\n    obj = obj[key] = obj[key] || { suite: suite };\n    suite.suites.forEach(function(suite) {\n      mapTOC(suite, obj);\n    });\n\n    return ret;\n  }\n\n  function stringifyTOC(obj, level) {\n    ++level;\n    var buf = '';\n    var link;\n    for (var key in obj) {\n      if (key === 'suite') {\n        continue;\n      }\n      if (key !== SUITE_PREFIX) {\n        link = ' - [' + key.substring(1) + ']';\n        link += '(#' + utils.slug(obj[key].suite.fullTitle()) + ')\\n';\n        buf += Array(level).join('  ') + link;\n      }\n      buf += stringifyTOC(obj[key], level);\n    }\n    return buf;\n  }\n\n  function generateTOC(suite) {\n    var obj = mapTOC(suite, {});\n    return stringifyTOC(obj, 0);\n  }\n\n  generateTOC(runner.suite);\n\n  runner.on('suite', function(suite) {\n    ++level;\n    var slug = utils.slug(suite.fullTitle());\n    buf += '<a name=\"' + slug + '\"></a>' + '\\n';\n    buf += title(suite.title) + '\\n';\n  });\n\n  runner.on('suite end', function() {\n    --level;\n  });\n\n  runner.on('pass', function(test) {\n    var code = utils.clean(test.body);\n    buf += test.title + '.\\n';\n    buf += '\\n```js\\n';\n    buf += code + '\\n';\n    buf += '```\\n\\n';\n  });\n\n  runner.on('end', function() {\n    process.stdout.write('# TOC\\n');\n    process.stdout.write(generateTOC(runner.suite));\n    process.stdout.write(buf);\n  });\n}\n"]}