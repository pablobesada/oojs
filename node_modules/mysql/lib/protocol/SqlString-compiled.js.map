{"version":3,"sources":["SqlString.js"],"names":[],"mappings":"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","file":"SqlString-compiled.js","sourcesContent":["var SqlString = exports;\n\nSqlString.escapeId = function (val, forbidQualified) {\n  if (Array.isArray(val)) {\n    return val.map(function(v) {\n      return SqlString.escapeId(v, forbidQualified);\n    }).join(', ');\n  }\n\n  if (forbidQualified) {\n    return '`' + val.replace(/`/g, '``') + '`';\n  }\n  return '`' + val.replace(/`/g, '``').replace(/\\./g, '`.`') + '`';\n};\n\nSqlString.escape = function(val, stringifyObjects, timeZone) {\n  if (val === undefined || val === null) {\n    return 'NULL';\n  }\n\n  switch (typeof val) {\n    case 'boolean': return (val) ? 'true' : 'false';\n    case 'number': return val+'';\n  }\n\n  if (val instanceof Date) {\n    val = SqlString.dateToString(val, timeZone || 'local');\n  }\n\n  if (Buffer.isBuffer(val)) {\n    return SqlString.bufferToString(val);\n  }\n\n  if (Array.isArray(val)) {\n    return SqlString.arrayToList(val, timeZone);\n  }\n\n  if (typeof val === 'object') {\n    if (stringifyObjects) {\n      val = val.toString();\n    } else {\n      return SqlString.objectToValues(val, timeZone);\n    }\n  }\n\n  val = val.replace(/[\\0\\n\\r\\b\\t\\\\\\'\\\"\\x1a]/g, function(s) {\n    switch(s) {\n      case \"\\0\": return \"\\\\0\";\n      case \"\\n\": return \"\\\\n\";\n      case \"\\r\": return \"\\\\r\";\n      case \"\\b\": return \"\\\\b\";\n      case \"\\t\": return \"\\\\t\";\n      case \"\\x1a\": return \"\\\\Z\";\n      default: return \"\\\\\"+s;\n    }\n  });\n  return \"'\"+val+\"'\";\n};\n\nSqlString.arrayToList = function(array, timeZone) {\n  return array.map(function(v) {\n    if (Array.isArray(v)) return '(' + SqlString.arrayToList(v, timeZone) + ')';\n    return SqlString.escape(v, true, timeZone);\n  }).join(', ');\n};\n\nSqlString.format = function(sql, values, stringifyObjects, timeZone) {\n  values = values == null ? [] : [].concat(values);\n\n  var index = 0;\n  return sql.replace(/\\?\\??/g, function(match) {\n    if (index === values.length) {\n      return match;\n    }\n\n    var value = values[index++];\n\n    return match === '??'\n      ? SqlString.escapeId(value)\n      : SqlString.escape(value, stringifyObjects, timeZone);\n  });\n};\n\nSqlString.dateToString = function dateToString(date, timeZone) {\n  var dt = new Date(date);\n\n  var year;\n  var month;\n  var day;\n  var hour;\n  var minute;\n  var second;\n  var millisecond;\n\n  if (timeZone === 'local') {\n    year        = dt.getFullYear();\n    month       = dt.getMonth() + 1;\n    day         = dt.getDate();\n    hour        = dt.getHours();\n    minute      = dt.getMinutes();\n    second      = dt.getSeconds();\n    millisecond = dt.getMilliseconds();\n  } else {\n    var tz = convertTimezone(timeZone);\n\n    if (tz !== false && tz !== 0) {\n      dt.setTime(dt.getTime() + (tz * 60000));\n    }\n\n    year       = dt.getUTCFullYear();\n    month       = dt.getUTCMonth() + 1;\n    day         = dt.getUTCDate();\n    hour        = dt.getUTCHours();\n    minute      = dt.getUTCMinutes();\n    second      = dt.getUTCSeconds();\n    millisecond = dt.getUTCMilliseconds();\n  }\n\n  // YYYY-MM-DD HH:mm:ss.mmm\n  return zeroPad(year, 4) + '-' + zeroPad(month, 2) + '-' + zeroPad(day, 2) + ' ' +\n    zeroPad(hour, 2) + ':' + zeroPad(minute, 2) + ':' + zeroPad(second, 2) + '.' +\n    zeroPad(millisecond, 3);\n};\n\nSqlString.bufferToString = function bufferToString(buffer) {\n  return \"X'\" + buffer.toString('hex') + \"'\";\n};\n\nSqlString.objectToValues = function(object, timeZone) {\n  var values = [];\n  for (var key in object) {\n    var value = object[key];\n    if(typeof value === 'function') {\n      continue;\n    }\n\n    values.push(this.escapeId(key) + ' = ' + SqlString.escape(value, true, timeZone));\n  }\n\n  return values.join(', ');\n};\n\nfunction zeroPad(number, length) {\n  number = number.toString();\n  while (number.length < length) {\n    number = '0' + number;\n  }\n\n  return number;\n}\n\nfunction convertTimezone(tz) {\n  if (tz === 'Z') {\n    return 0;\n  }\n\n  var m = tz.match(/([\\+\\-\\s])(\\d\\d):?(\\d\\d)?/);\n  if (m) {\n    return (m[1] == '-' ? -1 : 1) * (parseInt(m[2], 10) + ((m[3] ? parseInt(m[3], 10) : 0) / 60)) * 60;\n  }\n  return false;\n}\n"]}