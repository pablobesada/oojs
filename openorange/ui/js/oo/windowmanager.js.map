{"version":3,"sources":["windowmanager.es6"],"names":[],"mappings":"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","file":"windowmanager.js","sourcesContent":["\"use strict\";\n\n(function ($) {\n    var _ = require(\"underscore\");\n    var cm = require(\"openorange\").classmanager;\n\n    var WindowContainer = Object.create(null);\n    WindowContainer.windows = [];\n    WindowContainer.element_ids = 1;\n    WindowContainer.datePickerOptions = {\n        closeOnSelect: true,\n        selectMonths: true, // Creates a dropdown to control month\n        selectYears: 15, // Creates a dropdown of 15 years to control year\n        formatSubmit: \"yyyy-mm-dd\",\n        format: \"dd-mm-yyyy\",\n        onSet: function (arg) {\n            if ('select' in arg) { //prevent closing on selecting month/year\n                this.close();\n            }\n        }\n    };\n\n    WindowContainer.setFocus = function setFocus(window) {\n        for (var i = 0; i < WindowContainer.windows.length; i++) {\n            var w = WindowContainer.windows[i];\n            if (w.window === window) {\n                $('ul.tabs').tabs('select_tab', w.tab_id);\n            }\n        }\n    }\n\n    WindowContainer.init = function (wnd) {\n        this.window = wnd;\n        this.windowjson = JSON.parse(JSON.stringify(this.window.__class__.getDescription().form));  //deep clone of the object because I need to add some metadata to it\n        this.window.__container_data__ = {};\n        this.last_tab_id = 0;\n        this.last_tab_id = 0;\n        this.matrix_idx = 0;\n        this.matrix_json_map = {};\n        this.virtual_rows = {};\n        this.pastewindow_id = null;\n        return this;\n    };\n\n    WindowContainer.render = function render() {\n\n        var self = this;\n        //console.log(containerElement)\n        var html = '<div class=\"container\"></div>';\n        var w = $(html);\n        w.append(self.createToolBar());\n        this.tab_id = \"tab_window_\" + (WindowContainer.windows.length + 1);\n        WindowContainer.windows.push({window: this.window, element: w, tab_id: this.tab_id});\n        w.append(self.createComponent(this.windowjson));\n        w.append(self.createPasteWindow());\n        //console.log(this.windowjson)\n        this.__element__ = w;\n        this.displayWindow(w)\n    };\n\n    WindowContainer.displayWindow = function displayWindow(windowElement) {\n        var tab = $('<li class=\"tab col s3\"><a href=\"#' + this.tab_id + '\">' + this.window.getTitle() + '</a></li>');\n        $('ul.tabs.workspace').append(tab);\n        windowElement.attr('id', this.tab_id);\n        $('#workspace').append(windowElement);\n        $('ul.tabs').tabs();\n        //$('.modal-trigger').leanModal();\n        windowElement.find('.datepicker').pickadate(WindowContainer.datePickerOptions);\n        //$('input.editor[timeeditor=true]').mask('00:00:00');\n        if (this.window.getRecord() != null) this.bindRecordToWindow(this.window.getRecord());\n        this.window.addListener(this);\n    };\n\n    WindowContainer.createToolBar = function createToolBar() {\n        var self = this;\n        var html = '<div class=\"row\">';\n        html += '<a class=\"btn waves-effect waves-light\" action=\"save\"><i class=\"mdi\">done</i></a>';\n        for (let i=0;i<self.window.__class__.getDescription().actions.length;i++) {\n            let action = self.window.__class__.getDescription().actions[i]\n            html += `<a class=\"btn waves-effect waves-light\" action=\"${action.methodname}\">${action.label}</a>`;\n        }\n\n        html += '</div>';\n        var res = $(html);\n        //res.find(\"a\").click(function (event) {self.save(event)});\n        res.find(\"a[action=save]\").click(this.save.bind(this));\n        for (let i=0;i<self.window.__class__.getDescription().actions.length;i++) {\n            let action = self.window.__class__.getDescription().actions[i];\n            let params = {self: self, methodname: action.methodname}\n            res.find(`a[action=${action.methodname}]`).click(self.actionClicked.bind(params));\n        }\n        return res;\n    };\n\n    WindowContainer.setWindowTitle = function setWindowTitle(title) {\n        $(\"a[href='#\" + this.tab_id + \"']\").html(title)\n    };\n\n    WindowContainer.createComponent = function createComponent(json) {\n        var self = this;\n        if ('columns' in json) return self.createEmptyMatrix(json);\n        if ('field' in json) return self.createFieldComponent(json);\n        if ('type' in json && json.type == 'tabs') return self.createTabsComponent(json);\n        if ('type' in json && json.type == 'column') return self.createColumnComponent(json);\n        if ('type' in json && json.type == 'line') return self.createLineComponent(json);\n        if ('content' in json) return self.createComponent(json.content);\n        if (json instanceof Array) {\n            var container = $('<div class=\"container\"></div>');\n            _(json).forEach(function (jcomponent) {\n                container.append(self.createComponent(jcomponent))\n            });\n            json.__element__ = container;\n            return container;\n        }\n    };\n\n\n    WindowContainer.createColumnComponent = function createColumnComponent(json) {\n        var self = this;\n        var component = $('<div class=\"row\"></div>');\n        _(json.content).forEach(function (child_component_json) {\n            var component_row = $('<div class=\"row\"></div>');\n            var component_col = $('<div class=\"col s12\"></div>');\n            var child_component = self.createComponent(child_component_json);\n            component_col.append(child_component)\n            component_row.append(component_col)\n            component.append(component_row);\n        });\n        json.__element__ = component;\n        return component;\n    };\n\n    WindowContainer.createLineComponent = function createLineComponent(json) {\n        var self = this;\n        var component = $('<div class=\"row\"></div>');\n        _(json.content).forEach(function (child_component_json) {\n            var child_component = self.createComponent(child_component_json);\n            component.append(child_component);\n        });\n        json.__element__ = component;\n        return component;\n    };\n\n    WindowContainer.createTabsComponent = function createTabsComponent(json) {\n        var self = this;\n        var component = $('<div class=\"row\"></div>');\n        var tabsHeaderContainer = $('<div class=\"col s12\"></div>');\n        var tabsHeader = $('<ul class=\"tabs\"></ul>');\n        tabsHeaderContainer.append(tabsHeader);\n        component.append(tabsHeaderContainer);\n        _(json.pages).forEach(function (jpage) {\n            var label = jpage.label;\n            self.last_tab_id += 1;\n            var tab_id = self.tab_id + \"_\" + self.last_tab_id;\n            var headerButton = $('<li class=\"tab col s3\"><a href=\"#' + tab_id + '\">' + label + '</a></li>');\n            tabsHeader.append(headerButton);\n            var page = self.createComponent(jpage, {id: tab_id});\n            page.attr('id', tab_id);\n            component.append(page);\n        });\n        json.__element__ = component;\n        return component;\n    };\n\n\n    WindowContainer.createFieldComponent = function createFieldComponent(json) {\n        var self = this;\n        var editor;\n        var grid_cols = 4;\n        var headerInput = true;\n        var rclass = this.window.getRecordClass();\n        var field = rclass.__description__.fields[json.field];\n        if (!field) throw new Error(\"Field \" + json.field + \" not found in record\");\n        if ('editor' in json) {\n            editor = json.editor;\n        } else {\n            switch (field.type) {\n                case 'string':\n                    editor = 'string';\n                    break;\n                case 'integer':\n                    editor = 'integer';\n                    break;\n                case 'boolean':\n                    editor = 'checkbox';\n                    break;\n                case 'date':\n                    editor = 'date';\n                    break;\n                case 'time':\n                    editor = 'time';\n                    break;\n                case 'detail':\n                    editor = 'matrix';\n                    grid_cols = 12;\n                    headerInput = false;\n                    break;\n            }\n        }\n        var component = $('<div class=\"input-field col s' + grid_cols + '\"></div>');\n        var labelComponent = null;\n        var editorElement = self[editor](json, \"oomaster\");\n        var editors = editorElement;\n        var pasteWindowComponent = null;\n        if (headerInput) {\n            switch (editor) {\n                case 'checkbox':\n                    editors = editorElement.find(\"input\");\n                    editors.click(self.beforeEdit.bind(self));  //en el checkbox, el beforeEdit llama al afterEdit (esto es porque no siempre recibe eventos de focus -a veces se llama una sola vez y luego nunca mas-\n                    break;\n                case 'radiobutton':\n                    editors = editorElement.find(\"input\");\n                    editors.click(self.beforeEdit.bind(self));\n                    editors.change(self.afterEdit.bind(self));\n                    break;\n                case 'combobox':\n                    labelComponent = $('<label>' + (json.label ? json.label : json.field) + '</label>');\n                    editors.change(self.beforeEdit.bind(self)); //en el combobox, el beforeEdit llama al afterEdit (esto es porque no recibe eventos ni de click ni de focus\n                    break;\n                case 'date':\n                    labelComponent = $('<label>' + (json.label ? json.label : json.field) + '</label>');\n                    //editors.focus(self.beforeEdit.bind(self));\n                    editors.change(self.beforeEdit.bind(self));\n                    break;\n                default:\n                    labelComponent = $('<label>' + (json.label ? json.label : json.field) + '</label>');\n                    editors.focus(self.beforeEdit.bind(self));\n                    editors.change(self.afterEdit.bind(self));\n                    break;\n            }\n        }\n        if (json.pastewindow) {\n            pasteWindowComponent = $('<i class=\"mdi prefix\">search</i>')\n            var params = {self: self, field: field, detailname: null, rownr: null, json: json, editor: editors};\n            pasteWindowComponent.click(self.openPasteWindow.bind(params));\n        }\n        if (pasteWindowComponent) component.append(pasteWindowComponent);\n        component.append(editorElement);\n        if (labelComponent) component.append(labelComponent);\n        json.__element__ = editors;\n        return component;\n    };\n\n    WindowContainer.createMatrixComponent = function createMatrixComponent(json, cls, detailname, rownr, rowfield) {\n        var self = this;\n        var editor;\n        if ('editor' in json) {\n            editor = json.editor;\n        } else {\n            switch (rowfield.type) {\n                case 'string':\n                    editor = 'string';\n                    break;\n                case 'integer':\n                    editor = 'integer';\n                    break;\n                case 'date':\n                    editor = 'date';\n                    break;\n                case 'boolean':\n                    editor = 'checkbox';\n                    break;\n            }\n        }\n        var editorElement = self[editor](json, cls, rowfield);\n        var editors = editorElement;\n        var bind_params = {self: self, json: json, detailname: detailname, rowfield: rowfield};\n        switch (editor) {\n            case 'checkbox':\n                editors = editorElement.find(\"input\");\n                editors.click(self.beforeEditRow.bind(bind_params));\n                break;\n            case 'combobox':\n                editors.change(self.beforeEditRow.bind(bind_params));\n                break;\n            case 'date':\n                editors.change(self.beforeEditRow.bind(bind_params));\n                break;\n            default:\n                editors.focus(self.beforeEditRow.bind(bind_params));\n                editors.change(self.afterEditRow.bind(bind_params));\n                break;\n        }\n        var component = editors;\n        if (json.pastewindow) {\n            component = $('<div class=\"input-field\"></div>');\n            var pasteWindowComponent = $('<i class=\"mdi prefix\">search</i>');\n            component.append(pasteWindowComponent);\n            var params = {\n                self: self,\n                detailname: detailname,\n                field: rowfield,\n                rownr: rownr,\n                json: json,\n                editor: editors\n            };\n            pasteWindowComponent.click(self.openPasteWindow.bind(params));\n            component.append(editors)\n        }\n        json.__element__ = editors;\n        return component;\n    };\n\n\n    WindowContainer.save = function save() {\n        this.window.save()\n    };\n\n    WindowContainer.string = function string(json, cls, field) {\n        var self = this;\n        var value = field != null ? field.getValue() : '';\n        if (field != null && field.type == 'date' && value != null) value = value.format(\"YYYY-MM-DD\");\n        if (value == null) value = '';\n        var html = '<input value=\"' + value + '\" type=\"text\" name=\"' + json.field + '\" class=\"editor ' + cls + ' validate\">';\n        var res = $(html);\n        return res;\n    };\n\n    WindowContainer.time = function time(json, cls, field) {\n        var res = this.string(json, cls, field);\n        res.attr('timeeditor', true);\n        //res.attr('data-mask', '00:00:00')\n        res.mask('09:00:00');\n        return res;\n    };\n\n    WindowContainer.integer = function integer(json, cls, field) {\n        var self = this;\n        var value = field != null ? field.getValue() : '';\n        if (value == null) value = '';\n        var html = '<input value=\"' + value + '\" type=\"number\" name=\"' + json.field + '\" class=\"editor ' + cls + ' validate\">';\n        var res = $(html);\n        return res;\n    };\n\n    WindowContainer.date = function date(json, cls, field) {\n        var self = this;\n        var value = field != null ? field.getSQLValue() : '';\n        if (value == null) value = '';\n        var html = '<input data-value=\"' + value + '\" type=\"date\" name=\"' + json.field + '\" class=\"editor datepicker ' + cls + ' validate\" datepicker=\"true\">';\n        var res = $(html);\n        return res;\n    };\n\n    WindowContainer.checkbox = function checkbox(json, cls, field) {\n        var self = this;\n        var value = field != null ? field.getValue() : '';\n        if (value == null) value = '';\n        var checked = value == '' ? '' : 'checked =\"checked\"';\n        var element_id = \"CHECKBOX_\" + WindowContainer.element_ids++;\n        var html = '<p><input ' + checked + ' type=\"checkbox\" name=\"' + json.field + '\" class=\"editor ' + cls + ' validate\" id=\"' + element_id + '\">';\n        var label = '';\n        if (field == null) { //esto significa que me llamaron desde el header y no desde un matrix\n            label = (json.label ? json.label : json.field)\n        }\n        html += '<label for=\"' + element_id + '\">' + label + '</label></p>';\n        var res = $(html);\n        return res;\n    };\n\n    WindowContainer.combobox = function combobox(json, cls, field) {\n        var self = this;\n        var value = field != null ? field.getValue() : '';\n        if (value == null) value = '';\n        var html = '<select value=\"' + value + '\" type=\"text\" name=\"' + json.field + '\" class=\"editor ' + cls + ' validate\">';\n        var selected = (value == '' || value == null) ? 'SELECTED' : '';\n        html += '<option value=\"\" ' + selected + '></option>';\n        for (var i = 0; i < json.options.length; i++) {\n            var option = json.options[i];\n            var selected = (value == ('' + option.value)) ? 'SELECTED' : '';  // (''+option.value) es porque sino '' == 0 -> TRUE\n            html += '<option value=\"' + option.value + '\" ' + selected + '>' + option.label + '</option>'\n        }\n        html += '</select>';\n        var res = $(html);\n        return res;\n    };\n\n    WindowContainer.radiobutton = function radiobutton(json, cls, field) {\n        var self = this;\n        var value = field != null ? field.getValue() : '';\n        if (value == null) value = '';\n        var html = '';\n        for (var i = 0; i < json.options.length; i++) {\n            var option = json.options[i];\n            var element_id = \"RADIO_\" + WindowContainer.element_ids++;\n            html += '<p><input value=\"' + option.value + '\" type=\"radio\" name=\"' + json.field + '\" class=\"editor ' + cls + ' validate\" id=\"' + element_id + '\">';\n            html += '<label for=\"' + element_id + '\">' + option.label + '</label></p>';\n        }\n        var res = $(html)//.find(\"input\");\n        return res;\n    };\n    ;\n\n    WindowContainer.beforeEdit = function beforeEdit(event) {\n        var self = this;\n        if (self.window.getRecord() == null) return;\n        var target = $(event.currentTarget);\n        if ('__block_event__' in event.currentTarget && event.currentTarget.__block_event__) return;\n        var readonly = !Boolean(self.window.beforeEdit(event.currentTarget.name));\n        if (event.currentTarget.nodeName == 'INPUT' && $(event.currentTarget).attr('type') == 'radio') {\n            if (readonly) {\n                target.parent().parent().find(\"input[value=\" + self.window.getRecord()[event.currentTarget.name] + \"]\")[0].checked = true;\n            }\n        } else if (event.currentTarget.nodeName == 'INPUT' && $(event.currentTarget).attr('type') == 'checkbox') {\n            if (readonly) {\n                target[0].checked = Boolean(self.window.getRecord()[event.currentTarget.name]);\n            } else {\n                self.afterEdit(event);\n            }\n        }\n        else if (event.currentTarget.nodeName == 'SELECT') {\n            if (readonly) {\n                target.val(self.window.getRecord()[event.currentTarget.name]);\n                target.material_select();\n            } else {\n                self.afterEdit(event)\n            }\n        } else if (event.currentTarget.nodeName == 'INPUT' && target.attr('datepicker') == 'true') {\n            if (readonly) {\n                target.pickadate('picker').close();\n                var d = null;\n                var value = self.window.getRecord()[event.currentTarget.name];\n                if (value != null && value != '') {\n                    d = moment(value, \"YYYY-MM-DD\").toDate()\n                }\n                event.currentTarget.__block_event__ = true;\n                target.pickadate('picker').set('select', d);\n                event.currentTarget.__block_event__ = false;\n            } else {\n                self.afterEdit(event)\n            }\n        } else {\n            target.attr(\"readonly\", readonly);\n        }\n    };\n\n    WindowContainer.beforeEditRow = function beforeEditRow(event) {\n        console.log(\"en before edit row\");\n        if ('__block_event__' in event.currentTarget && event.currentTarget.__block_event__) return;\n        var params = this;\n        var self = params.self;\n        var target = $(event.currentTarget);\n        target.css('border-bottom', 'none');\n        target.css('box-shadow', 'none');\n        var readonly = null;\n        var rownr = target.closest(\"tr\").attr(\"rownr\");\n        if (rownr == 'null') { //virtual_row\n            //si la fila anterior esta toda vacia, entonces no agrego otra nueva fila\n            var tr = target.closest(\"tr\");\n            var tr_index = tr.index();\n            if (tr_index == 0 || !self.window.getRecord()[params.detailname][tr_index - 1].isEmpty()) {\n                var newrow = self.window.getRecord()[params.detailname].newRow();\n\n                var addedRow = self.virtual_rows[params.detailname];\n                var tbody = target.closest(\"tbody\");\n                addedRow.__window_container_avoid_insert__ = tbody.attr('matrix_idx');\n                self.window.getRecord()[params.detailname].push(self.virtual_rows[params.detailname]);\n                delete addedRow.__window_container_avoid_insert__;\n                tr.attr('rownr', addedRow.rowNr); //esto va antes del push para que durante el push toda este tr del table se complete con los valores que pudiera tener o que se seteen en el defaults del row (todo eso se corre adentro del push)\n                _(addedRow.fieldNames()).forEach(function (fn) {\n                    var value = addedRow[fn];\n                    if (value != null) {\n                        self.update({\n                            type: 'field', action: 'modified', data: {\n                                record: self.window.getRecord(),\n                                field: self.window.getRecord().details(params.detailname),\n                                row: addedRow,\n                                rowfield: addedRow.fields(fn),\n                                oldvalue: value\n                            }\n                        });\n                    }\n                });\n                self.virtual_rows[params.detailname] = self.window.getRecord()[params.detailname].newRow();\n                var json = _(self.matrix_json_map[params.detailname]).find(function (json) {\n                    return json.__element__.find(\"tbody\").attr(\"matrix_idx\") == tbody.attr(\"matrix_idx\")\n                });\n                self.insertMatrixRow(self.window.getRecord(), json, self.virtual_rows[params.detailname], tbody)\n            } else {\n                readonly = true;\n            }\n        }\n        if (readonly == null) readonly = !Boolean(self.window.beforeEditRow(this.detailname, this.rowfield.name, rownr));\n        if (event.currentTarget.nodeName == 'INPUT' && $(event.currentTarget).attr('type') == 'checkbox') {\n            if (readonly) {\n                target[0].checked = Boolean(self.window.getRecord()[this.detailname][rownr][this.rowfield.name]);\n            } else {\n                self.afterEditRow.call(params, event);\n            }\n        } else if (event.currentTarget.nodeName == 'SELECT') {\n            if (readonly) {\n                target.val(self.window.getRecord()[this.detailname][rownr][this.rowfield.name]);\n                target.material_select();\n            } else {\n                self.afterEditRow.call(params, event);\n            }\n        }\n        if (event.currentTarget.nodeName == 'INPUT' && target.attr('datepicker') == 'true') {\n            if (readonly) {\n                target.pickadate('picker').close();\n                var d = null;\n                var value = self.window.getRecord()[this.detailname][rownr][this.rowfield.name];\n                if (value != null && value != '') {\n                    d = moment(value, \"YYYY-MM-DD\").toDate()\n                }\n                event.currentTarget.__block_event__ = true;\n                target.pickadate('picker').set('select', d);\n                event.currentTarget.__block_event__ = false;\n            } else {\n                self.afterEditRow.call(params, event)\n            }\n        } else {\n            target.attr(\"readonly\", readonly);\n        }\n    };\n\n    WindowContainer.afterEdit = function afterEdit(event) {\n        var self = this;\n        console.log(\"afteredit\");\n        var value = event.currentTarget.value;\n        if (event.currentTarget.nodeName == 'INPUT' && $(event.currentTarget).attr('type') == 'checkbox') {\n            var ftype = self.window.getRecord().fields(event.currentTarget.name).type;\n            if (ftype == 'boolean') {\n                value = event.currentTarget.checked;\n            } else {\n                value = event.currentTarget.checked ? 1 : 0;\n            }\n        } else if (event.currentTarget.nodeName == 'INPUT' && $(event.currentTarget).attr('datepicker') == 'true') {\n            value = $(event.currentTarget).pickadate('picker').get('select', 'yyyy-mm-dd');\n        }\n        //console.log(\"afteredit\", self, value)\n        self.window.call_afterEdit(event.currentTarget.name, value)\n    };\n\n    WindowContainer.afterEditRow = function afterEditRow(event) {\n        console.log(\"en after edit row\");\n        var params = this;\n        var self = params.self;\n        var target = $(event.currentTarget);\n        target.css('border-bottom', 'none');\n        target.css('box-shadow', 'none');\n        var rownr = target.closest(\"tr\").attr(\"rownr\");\n        var value = target.val();\n        if (event.currentTarget.nodeName == 'INPUT' && target.attr('type') == 'checkbox') {\n            var ftype = self.window.getRecord().details(params.detailname).getRowClass().__description__.fields[params.rowfield.name].type;\n            if (ftype == 'boolean') {\n                value = event.currentTarget.checked;\n            } else {\n                value = event.currentTarget.checked ? 1 : 0;\n            }\n        } else if (event.currentTarget.nodeName == 'INPUT' && target.attr('datepicker') == 'true') {\n            value = target.pickadate('picker').get('select', 'yyyy-mm-dd');\n        }\n        self.window.afterEditRow(params.detailname, params.rowfield.name, rownr, value);\n    };\n\n\n    WindowContainer.update = function update(event) {\n        var self = this;\n        switch (event.type) {\n            case \"record\":\n                if (event.action == 'replaced') self.bindRecordToWindow(event.data);\n                break;\n            case \"field\":\n                //console.log(event)\n                if (event.action == 'modified') {\n                    var field = event.data.field;\n                    if (field.type != \"detail\") {\n                        self.setEditorValue(field.name, field.type, field.getValue());\n                        Materialize.updateTextFields();\n                    } else {\n                        console.log(\"row: \" + event.data.rowfield.name)\n                        var rowNr = event.data.row.rowNr;\n                        if (event.data.rowfield.name == 'rowNr') rowNr = event.data.oldvalue; //si lo que cambio fue el rowNr del row entonces uso el valor anterior a la modificacion para identificar el la fila a modificar\n                        console.log(event.data.field.name, rowNr, event.data.rowfield.name, event.data.rowfield.type, event.data.rowfield.getValue())\n                        self.setRowEditorValue(event.data.field.name, rowNr, event.data.rowfield.name, event.data.rowfield.type, event.data.rowfield.getValue());\n                        Materialize.updateTextFields();\n                    }\n                } else if (event.action == 'row inserted') {\n                    var detail = event.data.detail;\n                    if (detail.name in this.matrix_json_map) {\n                        _(this.matrix_json_map[detail.name]).forEach(function (matrixjson) {\n                            var tbody = matrixjson.__element__.find(\"tbody[matrix_idx]\");\n                            self.insertMatrixRow(event.data.record, matrixjson, event.data.row, tbody);\n                        })\n\n                    }\n                } else if (event.action == 'detail cleared') {\n                    var detail = event.data.detail;\n                    if (detail.name in this.matrix_json_map) {\n                        _(this.matrix_json_map[detail.name]).forEach(function (matrixjson) {\n                            var tbody = matrixjson.__element__.find(\"tbody\");\n                            tbody.find(\"tr\").not('[rowNr=null]').remove();\n                        })\n                    }\n                }\n                break;\n            case \"title\":\n                if (event.action == \"modified\") {\n                    self.setWindowTitle(event.data)\n                }\n                break;\n        }\n    };\n\n    WindowContainer.insertMatrixRow = function insertMatrixRow(record, json, row, tbodyElement, position) {\n        if (row.__window_container_avoid_insert__ == tbodyElement.attr(\"matrix_idx\")) {\n            //self.insertMatrixRow(record, json, self.virtual_rows[json.field], tbody)\n            return;\n        }\n        var self = this;\n        var tbody = tbodyElement;\n        var tr = $('<tr rownr=\"' + row.rowNr + '\"></tr>');\n\n        _(json.columns).forEach(function (jcol) {\n            var td = $('<td></td>');\n            var component = self.createMatrixComponent(jcol, 'oodetail', json.field, row.rowNr, row.fields(jcol.field));\n            var readonly = !record.fieldIsEditable(json.field, jcol.field, row.rowNr);\n            if (readonly) component.attr('readonly', readonly);\n            component.css('border-bottom', 'none');\n            component.css('box-shadow', 'none');\n            td.append(component);\n            tr.append(td)\n        });\n\n        var trs = tbody.children(\"tr\");\n        var hasVirtualRow = (trs.length > 0 && trs.last().attr('rownr') == 'null');\n        var rows_count = trs.length;\n        if (hasVirtualRow) rows_count -= 1;\n        if (row.rowNr >= rows_count || row.rowNr == null) { //row.rowNr == null -> virtual_row\n            if (hasVirtualRow) {\n                trs.last().before(tr);\n            } else {\n                tbody.append(tr);\n            }\n        } else {\n            var next_tr = null;\n            for (var i = rows_count - 1; i >= row.rowNr; i--) {\n                next_tr = tbody.children('tr[rownr=' + i + ']');\n                next_tr.attr('rownr', i + 1)\n            }\n            next_tr.before(tr)\n        }\n        tr.find(\"select\").material_select();\n        tr.find(\"input[datepicker=true]\").pickadate(WindowContainer.datePickerOptions);\n        return tr;\n    };\n\n    WindowContainer.setEditorValue = function setEditorValue(fname, ftype, value) {\n        var elements = this.__element__.find('.editor.oomaster[name=' + fname + ']');\n        for (var i = 0; i < elements.length; i++) {\n            var element = elements[i];\n            var e = $(element);\n            if (element.nodeName == 'SELECT') {\n                e.val(value);\n                e.material_select();\n            } else if (element.nodeName == 'INPUT' && e.attr('type') == 'radio') {\n                element.checked = (value == e.val());\n            } else if (element.nodeName == 'INPUT' && e.attr('type') == 'checkbox') {\n                element.checked = (value != null && value != '' && value != 0 && value != false);\n            } else if (element.nodeName == 'INPUT' && e.attr('datepicker') == 'true') {\n                var d = null;\n                if (value != null && value != '') {\n                    d = moment(value, \"YYYY-MM-DD\").toDate()\n                }\n                element.__block_event__ = true;\n                e.pickadate('picker').set('select', d);\n                element.__block_event__ = false;\n            } else {\n                if (ftype == 'date' && value != null) {\n                    e.val(value.format(\"YYYY-MM-DD\"))\n                } else {\n                    e.val(value)\n                }\n            }\n        }\n    };\n\n    WindowContainer.setRowEditorValue = function setRowEditorValue(detailname, rowNr, rowfieldname, rowfieldtype, value) {\n        var elements = this.__element__.find('table[name=' + detailname + '] tr[rownr=' + rowNr + '] .editor.oodetail[name=' + rowfieldname + ']');\n        for (var i = 0; i < elements.length; i++) {\n            var element = elements[i];\n            var e = $(element);\n            if (elements[i].nodeName == 'SELECT') {\n                e.val(value);\n                $(elements[i]).material_select();\n            } else if (element.nodeName == 'INPUT' && e.attr('type') == 'checkbox') {\n                element.checked = (value != null && value != '' && value != 0 && value != false);\n            } else if (element.nodeName == 'INPUT' && e.attr('datepicker') == 'true') {\n                var d = null;\n                if (value != null && value != '') {\n                    //d = moment(value, \"YYYY-MM-DD\").toDate()\n                    d = value.toDate()\n                }\n                //console.log(rowfield)\n                //console.log(\"a\", d,value.constructor)\n                element.__block_event__ = true;\n                e.pickadate('picker').set('select', d);\n                element.__block_event__ = false;\n            } else {\n                if (rowfieldtype == 'date' && value != null) {\n                    e.val(value.format(\"YYYY-MM-DD\"))\n                } else {\n                    e.val(value)\n                }\n            }\n\n        }\n    };\n\n    WindowContainer.setEditorReadOnly = function setEditorReadOnly(field, readonly) {\n        this.__element__.find('.editor.oomaster[name=' + field.name + ']').attr('readonly', readonly)\n    };\n\n    WindowContainer.createEmptyMatrix = function createEmptyMatrix(json) {\n        var self = this;\n        var table = $('<table name=\"' + json.field + '\" class=\"bordered oodetail striped\"></table>');\n        var thead = $(\"<thead></thead>\");\n        var colHeaderRow = $(\"<tr></tr>\");\n        thead.append(colHeaderRow);\n        _(json.columns).forEach(function (col) {\n            var label = col.label ? col.label : col.field;\n            var colHeader = $(\"<th>\" + col.field + \"</ht>\");\n            colHeaderRow.append(colHeader)\n        });\n        table.append(thead);\n        var tbody = $('<tbody></tbody>');\n        self.matrix_idx += 1;\n        tbody.attr('matrix_idx', self.matrix_idx);\n        table.append(tbody);\n        json.__element__ = table;\n        if (!(json.field in this.matrix_json_map)) this.matrix_json_map[json.field] = [];\n        this.matrix_json_map[json.field].push(json);\n        return table;\n    };\n\n    WindowContainer.bindRecordToComponent = function bindRecordToComponent(record, jcomponent) {\n        var self = this;\n        if (jcomponent instanceof Array) {\n            _(jcomponent).forEach(function (json) {\n                if ('columns' in json) {\n                    var tbody = json.__element__.find(\"tbody\");\n                    tbody.html('');\n                    _(record[json.field]).forEach(function (row) {\n                        self.insertMatrixRow(record, json, row, tbody)\n                    });\n                    self.insertMatrixRow(record, json, self.virtual_rows[json.field], tbody)\n                } else if ('field' in json) {\n                    var field = record.fields(json.field);\n                    self.setEditorValue(field.name, field.type, field.getValue());\n                    self.setEditorReadOnly(field, !record.fieldIsEditable(json.field))\n                } else {\n                    var jcontent = null;\n                    if (json.pages instanceof Array) jcontent = json.pages;\n                    else if (json.content instanceof Array) jcontent = json.content;\n                    self.bindRecordToComponent(record, jcontent);\n                }\n            })\n        }\n    };\n\n    WindowContainer.bindRecordToWindow = function bindRecordToWindow(record) {\n        var self = this;\n        _(record.detailNames()).forEach(function (dn) {\n            var vt = record[dn].newRow();\n            //vt.rowNr =\n            self.virtual_rows[dn] = vt;\n        });\n        self.bindRecordToComponent(record, self.windowjson);\n        self.setWindowTitle(this.window.getTitle());\n        Materialize.updateTextFields();\n        self.__element__.find(\"select\").material_select()\n    };\n\n    WindowContainer.createPasteWindow = function createPasteWindow() {\n        var self = this;\n        self.pastewindow_id = \"PASTEWINDOW_\" + WindowContainer.element_ids++;\n        var html = '';\n        html += '<div id=\"' + self.pastewindow_id + '\" class=\"modal modal-fixed-footer green white-text pastewindow\" style=\"z-index: 1003; display: none; opacity: 0; transform: scaleX(0.7); top: 317.636px;\">';\n        html += '  <div class=\"modal-content\">';\n        html += '    <table class=\"recordlist\"><thead></thead><tbody></tbody></table>';\n        html += '  </div>';\n        html += '  <div class=\"modal-footer green lighten-4\">';\n        html += '    <a href=\"#\" class=\"waves-effect waves-red btn-flat modal-action modal-close\">Disagree</a>';\n        html += '    <a href=\"#\" class=\"waves-effect waves-green btn-flat modal-action modal-close\">Agree</a>';\n        html += '  </div>';\n        html += '</div>';\n        var pastewindow = $(html);\n        return pastewindow;\n\n    };\n\n    WindowContainer.openPasteWindow = function openPasteWindow(event) {\n        var params = this;\n        var self = params.self;\n        var field = params.field;\n        var fieldjson = params.json;\n        var pw = cm.getClass(fieldjson.pastewindow);\n        var pwelement = self.__element__.find(\".pastewindow\");\n        var recordClass = cm.getClass(pw.__description__.recordClass);\n        var columns = pw.__description__.columns;\n        var readonly = null;\n        if (params.detailname == null) {\n            readonly = !Boolean(self.window.beforeEdit(fieldjson.field));\n        } else {\n            readonly = !Boolean(self.window.beforeEditRow(params.detailname, fieldjson.field, params.rownr));\n        }\n        if (readonly) return;\n        var res = recordClass.select().fetch()\n            .then(function (records) {\n                var thead = pwelement.find(\".recordlist>thead\");\n                thead.find(\"tr\").remove()\n                var tbody = pwelement.find(\".recordlist>tbody\");\n                tbody.find(\"tr\").remove()\n                var tr = $(\"<tr></tr>\");\n                for (var i = 0; i < columns.length; i++) {\n                    tr.append($('<th>' + columns[i].field + '</th>'));\n                }\n                thead.append(tr);\n                for (var j = 0; j < records.length; j++) {\n                    var rec = records[j];\n                    var tr = $(\"<tr></tr>\");\n                    for (var i = 0; i < columns.length; i++) {\n                        var fn = columns[i].field;\n                        var value = rec[fn];\n                        if (value == null) value = '';\n                        tr.append($('<td>' + value + '</td>'));\n                    }\n                    var pasteparams = {\n                        self: self,\n                        detailname: params.detailname,\n                        rownr: params.rownr,\n                        field: field,\n                        fieldjson: fieldjson,\n                        pastewindow: pw,\n                        pastewindowelement: pwelement,\n                        editor: params.editor,\n                        record: rec\n                    };\n                    tr.click(self.recordSelectedInPasteWindow.bind(pasteparams));\n                    tbody.append(tr)\n                }\n            });\n        pwelement.openModal();\n    };\n\n    WindowContainer.recordSelectedInPasteWindow = function recordSelectedInPasteWindow() {\n        var params = this;\n        var self = params.self\n        params.pastewindowelement.closeModal()\n        var readonly = null;\n        if (params.detailname == null) {\n            readonly = !Boolean(self.window.beforeEdit(params.fieldjson.field));\n        } else {\n            readonly = !Boolean(self.window.beforeEditRow(params.detailname, params.fieldjson.field, params.rownr));\n        }\n        if (readonly) return;\n        var event = {target: params.editor[0], currentTarget: params.editor[0]};\n        if (params.detailname == null) {\n            self.setEditorValue(params.fieldjson.field, params.field.type, params.record[params.pastewindow.__description__.pastefieldname])\n            self.afterEdit(event)\n        } else {\n            console.log(params.detailname, params.rownr, params.fieldjson.field, params.field.type, params.record[params.pastewindow.__description__.pastefieldname])\n            self.setRowEditorValue(params.detailname, params.rownr, params.fieldjson.field, params.field.type, params.record[params.pastewindow.__description__.pastefieldname])\n            var bind_params = {\n                self: self,\n                json: params.fieldjson,\n                detailname: params.detailname,\n                rowfield: params.field\n            };   //self.window.getRecord().details(params.detailname)[params.rownr].fields(params.fieldjson.name)\n            self.afterEditRow.call(bind_params, event)\n        }\n    };\n\n    WindowContainer.actionClicked = async function actionClicked(event) {\n        let params = this;\n        let self = params.self;\n        let methodname = params.methodname;\n        await self.window.call_action(methodname);\n    }\n\n    $.extend(true, window.oo, {windowmanager: WindowContainer})\n    //window.WindowManager = WindowContainer; //para hacer global la variable WindowManager\n})(jQuery);\n"]}