{"version":3,"sources":["Embedded_Window.es6"],"names":[],"mappings":"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","file":"Embedded_Window.js","sourcesContent":["\"use strict\";\nvar oo = require(\"openorange\")\n\nvar WindowDescription = {\n    name: 'Embedded_Window',\n    inherits: null,\n}\n\nvar Embedded_Window = Object.create({\n    '__super__': null,\n    '__description__': WindowDescription,\n    '__filename__': __filename,\n})\n\nEmbedded_Window.new = function () {\n    var res = Object.create(this);\n    res.__class__ = this;\n    return res.init();\n}\n\nEmbedded_Window.open = function () {\n    var wm = Object.create(window.WindowManager).init(this)\n    wm.render($('#content')[0])\n}\n\nEmbedded_Window.setFocus = function setFocus() {\n    window.WindowManager.setFocus(this)\n}\n\nEmbedded_Window.createChildClass = function createChildClass(descriptor, filename) {\n    var childclass = Object.create(this)\n    childclass.__description__ = {}\n    childclass.__description__.name = descriptor.name;\n    childclass.__description__.title = descriptor.title;\n    childclass.__description__.recordClass = descriptor.record\n    childclass.__description__.form = descriptor.form;\n    childclass.__filename__ = filename;\n    childclass.__super__ = this;\n    this.__recordClass__ = null;\n    return childclass;\n}\n\nEmbedded_Window.init = function init() {\n    this.__record__ = null;\n    this.__listeners__ = []\n    this.__title__ = this.__class__.__description__.title;\n    return this;\n}\n\nEmbedded_Window.addListener = function addListener(listener) {\n    this.__listeners__.push(listener)\n}\n\nEmbedded_Window.notifyListeners = function notifyListeners(event) {\n    _(this.__listeners__).forEach(function (listener) {\n        listener.update(event);\n    })\n}\n\nEmbedded_Window.getRecordClass = function getRecordClass() {\n    if (this.__class__.__recordClass__ == null && this.__description__.recordClass) {\n        this.__class__.__recordClass__ = oo.classmanager.getClass(this.__description__.recordClass)\n    }\n    return this.__class__.__recordClass__\n}\n\nEmbedded_Window.super = function callSuper(methodname, self) {\n    if (methodname in this.__super__) {\n        return this.__super__[methodname].apply(self, Array.prototype.slice.apply(arguments).slice(2));\n    } else {\n        return Promise.resolve()\n    }\n}\n\nEmbedded_Window.getDescription = function getDescription() {\n    return this.__description__\n}\n\nEmbedded_Window.inspect = function inspect() {\n    return \"<\" + this.__description__.name + \", from \" + this.__filename__+ \">\"\n}\n\nEmbedded_Window.getOriginalTitle = function getOriginalTitle() {\n    return this.__class__.__description__.title\n}\n\nEmbedded_Window.getTitle = function getTitle() {\n    return this.getOriginalTitle();\n}\n\nEmbedded_Window.notifyTitleChanged = function notifyTitleChanged() {\n    this.notifyListeners({type: \"title\", action: \"modified\", data: this.getTitle()})\n}\n\nEmbedded_Window.setTitle = function setTitle(title) {\n    this.__title__ = title;\n    this.notifyListeners({type:\"title\", action: \"modified\", data: title})\n}\n\nEmbedded_Window.save = function save() {\n    if (this.getRecord() != null) {\n        return this.getRecord().save();\n    }\n    return Promise.resolve()\n}\n\nEmbedded_Window.setRecord = function setRecord(rec) {\n    if (this.__record__ != rec) {\n        this.__record__ = rec;\n        this.__record__.addListener(this)\n        this.notifyListeners({type: 'record', action: 'replaced', data: rec});\n    }\n}\n\nEmbedded_Window.fieldModified = function fieldModified(record, field, row, rowfield, oldvalue) {\n    this.notifyListeners({type: 'field', action: 'modified', data: {\n        record: record,\n        field: field,\n        row: row,\n        rowfield: rowfield,\n        oldvalue: oldvalue\n    }})\n}\n\nEmbedded_Window.rowInserted = function rowInserted(record, detail, row, position) {\n    this.notifyListeners({type: 'field', action: 'row inserted', data: {\n        record: record,\n        detail: detail,\n        row: row,\n        position: position\n    }})\n}\n\nEmbedded_Window.detailCleared = function detailCleared(record, detail, row, position) {\n    this.notifyListeners({type: 'field', action: 'detail cleared', data: {\n        record: record,\n        detail: detail,\n    }})\n}\n\nEmbedded_Window.getRecord = function getRecord(rec) {\n    return this.__record__\n}\n\nEmbedded_Window.beforeEdit = function beforeEdit(fieldname) {\n    var self = this;\n    var res=true;\n    if ('focus ' + fieldname in self) {\n        res = self['focus ' + fieldname]()\n        return res;\n    }\n    res = self.getRecord().fieldIsEditable(fieldname);\n    return res;\n}\n\nEmbedded_Window.beforeEditRow = function beforeEditRow(fieldname, rowfieldname, rownr) {\n    var self = this;\n    var res = true;\n    if ('focus ' + fieldname + \".\" + rowfieldname in self) {\n        res = self['focus ' + fieldname + \".\" + rowfieldname]()\n        return res;\n    }\n    res = self.getRecord().fieldIsEditable(fieldname, rowfieldname, rownr);\n    return res;\n}\n\nEmbedded_Window.afterEdit = function afterEdit(fieldname, value) {\n    var self = this;\n    self.getRecord()[fieldname] = value;\n    if ('changed ' + fieldname in this) {\n        this['changed ' + fieldname]()\n    }\n}\n\nEmbedded_Window.afterEditRow = function afterEditRow(fieldname, rowfieldname, rownr, value) {\n    var self = this;\n    self.getRecord()[fieldname][rownr][rowfieldname] = value;\n    if ('changed ' + fieldname + '.' + rowfieldname in this) {\n        this['changed ' + fieldname + '.' + rowfieldname](rownr)\n    }\n}\n\nEmbedded_Window.save = function save() {\n    var rec = this.getRecord();\n    if (rec != null) return rec.save();\n}\n\nmodule.exports = Embedded_Window\n"]}